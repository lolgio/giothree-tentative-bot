generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    discordId  Int        @id @unique
    createdAt  DateTime   @default(now())
    gbfAccount GbfPlayer?
}

model GbfCrew {
    id            Int                  @id @unique
    name          String               @unique
    leaderId      Int
    introduction  String?
    crewMembers   GbfPlayer[]
    gbfCrewGWData GbfCrewGWData[]
    trackedData   GbfTrackedCrewData[]
}

model GbfPlayer {
    id              Int               @id @unique
    level           Int
    nickname        String
    crew            GbfCrew?          @relation(fields: [crewId], references: [id])
    crewId          Int?
    crewPosition    Int?
    gbfPlayerGWData GbfPlayerGWData[]
    playerDiscord   User?             @relation(fields: [playerDiscordId], references: [discordId])
    playerDiscordId Int?              @unique
}

model GbfCrewGWData {
    crew          GbfCrew @relation(fields: [crewId], references: [id])
    crewId        Int
    gwNumber      Int
    ranking       Int?
    preliminaries Int?
    day1          Int?
    day2          Int?
    day3          Int?
    day4          Int?

    @@id([crewId, gwNumber])
}

model GbfTrackedCrewData {
    crew        GbfCrew  @relation(fields: [crewId], references: [id])
    createdAt   DateTime @default(now())
    crewId      Int
    gwNumber    Int
    totalHonors Int

    @@id([crewId, gwNumber, createdAt])
}

model GbfPlayerGWData {
    player        GbfPlayer @relation(fields: [playerId], references: [id])
    playerId      Int
    gwNumber      Int
    ranking       Int?
    preliminaries Int?
    interlude     Int?
    day1          Int?
    day2          Int?
    day3          Int?
    day4          Int?

    @@id([playerId, gwNumber])
}

model GbfEvent {
    id        String   @id @unique
    title     String
    startDate DateTime
    endDate   DateTime
    imgUrl    String
}

model DataAccount {
    uid     String @id @unique
    midship String
    wing    String
}
